const reference = [
  {
    name: 'William I',
    img: '/img/1.JPG',
    x: '/img/1X.JPG',
    from: 1066,
    to: 1087
  },
  {
    name: 'William II',
    img: '/img/2.JPG',
    x: '/img/2X.JPG',
    from: 1087,
    to: 1100
  },
  {
    name: 'Henry I',
    img: '/img/3.JPG',
    x: '/img/3X.JPG',
    from: 1100,
    to: 1135
  },
  {
    name: 'Stephen',
    img: '/img/4.JPG',
    x: '/img/4X.JPG',
    from: 1135,
    to: 1154
  },
  {
    name: 'Henry II',
    img: '/img/5.JPG',
    x: '/img/5X.JPG',
    from: 1154,
    to: 1189
  },
  {
    name: 'Richard I',
    img: '/img/6.JPG',
    x: '/img/6X.JPG',
    from: 1189,
    to: 1199
  },
  {
    name: 'John',
    img: '/img/7.JPG',
    x: '/img/7X.JPG',
    from: 1199,
    to: 1216
  },
  {
    name: 'Henry III',
    img: '/img/8.JPG',
    x: '/img/8X.JPG',
    from: 1216,
    to: 1272
  },
  {
    name: 'Edward I',
    img: '/img/9.JPG',
    x: '/img/9X.JPG',
    from: 1272,
    to: 1307
  },
  {
    name: 'Edward II',
    img: '/img/10.JPG',
    x: '/img/10X.JPG',
    from: 1307,
    to: 1327
  },
  {
    name: 'Edward III',
    img: '/img/11.JPG',
    x: '/img/11X.JPG',
    from: 1327,
    to: 1377
  },
  {
    name: 'Richard II',
    img: '/img/12.JPG',
    x: '/img/12X.JPG',
    from: 1377,
    to: 1399,
  },
  {
    name: 'Henry IV',
    img: '/img/13.JPG',
    x: '/img/13X.JPG',
    from: 1399,
    to: 1413,
  },
  {
    name: 'Henry V',
    img: '/img/14.JPG',
    x: '/img/14X.JPG',
    from: 1413,
    to: 1422,
  },
  {
    name: 'Henry VI',
    img: '/img/15.JPG',
    x: '/img/15X.JPG',
    from: 1422,
    to: 1461,
  },
  {
    name: 'Edward IV',
    img: '/img/16.JPG',
    x: '/img/16X.JPG',
    from: 1461,
    to: 1483,
  },
  {
    name: 'Edward V',
    img: '/img/17.JPG',
    x: '/img/17X.JPG',
    from: 1483,
    to: 1483,
  },
  {
    name: 'Richard III',
    img: '/img/18.JPG',
    x: '/img/18X.JPG',
    from: 1483,
    to: 1485,
  },
  {
    name: 'Henry VII',
    img: '/img/19.JPG',
    x: '/img/19X.JPG',
    from: 1485,
    to: 1509,
  },
  {
    name: 'Henry VIII',
    img: '/img/20.JPG',
    x: '/img/20X.JPG',
    y: '/img/20Y.JPG',
    from: 1509,
    to: 1547,
  },
  {
    name: 'Edward VI',
    img: '/img/21.JPG',
    x: '/img/21X.JPG',
    from: 1547,
    to: 1553,
  },
  {
    name: 'Jane',
    img: '/img/22.JPG',
    from: 1553,
    to: 1553,
  },
  {
    name: 'Mary I',
    img: '/img/23.JPG',
    x: '/img/23X.JPG',
    from: 1553,
    to: 1558,
  },
  {
    name: 'Elizabeth I',
    img: '/img/24.JPG',
    x: '/img/24X.JPG',
    y: '/img/24X.JPG',
    from: 1558,
    to: 1603,
  },
  {
    name: 'James I',
    img: '/img/25.JPG',
    x: '/img/25X.JPG',
    from: 1603,
    to: 1625,
  },
  {
    name: 'Charles I',
    img: '/img/26.JPG',
    x: '/img/26X.JPG',
    y: '/img/26Y.JPG',
    z: '/img/26Z.JPG',
    from: 1625,
    to: 1649
  },
  {
    name: 'Charles II',
    img: '/img/27.JPG',
    x: '/img/27X.JPG',
    y: '/img/27Y.JPG',
    from: 1660,
    to: 1685
  },
  {
    name: 'James II',
    img: '/img/28.JPG',
    x: '/img/28X.JPG',
    y: '/img/28Y.JPG',
    from: 1685,
    to: 1688
  },
  {
    name: 'William III & Mary II',
    img: '/img/29.JPG',
    x: '/img/29X.JPG',
    from: 1689,
    to: 1702
  },
  {
    name: 'Anne',
    img: '/img/30.JPG',
    x: '/img/30X.JPG',
    from: 1702,
    to: 1714
  },
  {
    name: 'George I',
    img: '/img/31.JPG',
    x: '/img/31X.JPG',
    from: 1714,
    to: 1727
  },
  {
    name: 'George II',
    img: '/img/32.JPG',
    x: '/img/32X.JPG',
    y: '/img/32Y.JPG',
    from: 1727,
    to: 1760
  },
  {
    name: 'George III',
    img: '/img/33.JPG',
    x: '/img/33X.JPG',
    y: '/img/33Y.JPG',
    z: '/img/33Z.JPG',
    zz: '/img/33Z.JPG',
    from: 1760,
    to: 1820
  },
  {
    name: 'George IV',
    img: '/img/34.JPG',
    x: '/img/34X.JPG',
    from: 1820,
    to: 1830
  },
  {
    name: 'William IV',
    img: '/img/35.JPG',
    x: '/img/35X.JPG',
    y: '/img/35Y.JPG',
    from: 1830,
    to: 1837
  },
  {
    name: 'Victoria',
    img: '/img/36.JPG',
    x: '/img/36X.JPG',
    y: '/img/36Y.JPG',
    z: '/img/36Z.JPG',
    from: 1837,
    to: 1901
  },
  {
    name: 'Edward VII',
    img: '/img/37.JPG',
    from: 1901,
    to: 1910
  },
  {
    name: 'George V',
    img: '/img/38.JPG',
    from: 1910,
    to: 1936
  },
  {
    name: 'Edward VIII',
    img: '/img/39.JPG',
    from: 1936,
    to: 1936
  },
  {
    name: 'George VI',
    img: '/img/40.JPG',
    from: 1936,
    to: 1952
  },
  {
    name: 'Elizabeth II',
    img: '/img/41.JPG',
    from: 1952,
    to: 2022
  },
  {
    name: 'Charles III',
    img: '/img/42.JPG',
    from: 2022,
    to: null
  }

]

export default function () {

  const kings = useState('kings', () => { return reference })
  const firstTime = useState('firstTime', () => { return true })

  // the search string entered by the user
  const search = useState('search', () => { return '' })

  // a computed filtered list of kings, only those matching the search
  const filteredKings = computed(() => {
    if (search.value === null || search.value.trim().length === 0) {
      return kings.value
    }

    const match = search.value.match(/([0-9][0-9][0-9][0-9])/)

    // search by year
    if (match) {
      const year = parseInt(match[0])
      return kings.value.filter((k) => {
        if (k.from <= year && (k.to === null || k.to >= year)) {
          return true
        }
      })
    }

    // don't filter if it's just numbers
    if (search.value.replace(/[0-9]/g, '').trim().length === 0) {
      return kings.value
    }

    // search by string
    const lc = search.value.toLowerCase().trim()
    const hasSpaces = lc.includes(' ')
    return kings.value.filter((k) => {
      if (hasSpaces) {
        return k.name.toLowerCase() === lc
      } else {
        return k.name.toLowerCase().includes(lc)
      }
    })
  })

  // add before and after to kings list
  if (firstTime.value) {
    for (let i = 0; i < kings.value.length; i++) {
      kings.value[i].before = i > 0 ? kings.value[i - 1].name : null
      kings.value[i].after = i < kings.value.length - 1 ? kings.value[i + 1].name : null
    }
    firstTime.value = false
  }

  return { kings, filteredKings, search }
}
